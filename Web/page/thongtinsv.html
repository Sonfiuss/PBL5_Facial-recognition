<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web quản lý sinh viên</title>
    <link rel="stylesheet"  href="../css/style.css">
    <link rel="stylesheet" href="../css/fontawesome/css/all.css">
    <style>
       
    </style>
</head>
<body>
    <div class="header">
        
    </div>
    <div class="menu"> 
        <ul class="list_menu">
            <li><a href="manage.html">Trang chủ</a></li>
            <li><a href="lop.html"><i class="fas fa-users"></i>&ensp;LỚP</a></li>
            <li><a href="sinhvien.html"><i class="fas fa-graduation-cap"></i>&ensp;SINH VIÊN</a></li>
            <li><a href="diemdanh.html"><i class="fas fa-check"></i>&ensp;ĐIỂM DANH</a></li>
            <li><a href="contact.html"><i class="fas fa-address-book"></i>&ensp;CONTACT</a></li>                
        </ul>
    </div>
    <div class="main">
        <div class="main-contain">
            <h2>SINH VIÊN - thông tin sinh viên</h2>
              <div id="thongtin">
                      <div id="avtGiangvien">
                            
                      </div>
                      <div id="chi_tiet">
                        <table>
                            <tr> 
                                <td>Mã số sinh viên </td>
                                <td> <input type="text" id="idsv" value="" readonly></td>
                            </tr>
                            <tr> 
                                <td>Họ tên </td>
                                <td> <input type="text" id="ten" value="" readonly></td>
                            </tr>
                            <tr>
                                <td>Ngày sinh </td>
                                <td> <input type="date" id="ngaysinh" value= "" readonly></td>
                            </tr>
                            <tr>
                                <td>Mail </td>
                                <td> <input type="text" id="mail" value="" readonly></td>
                            </tr>
                            <tr>
                                <td>Số điện thoại </td>
                                <td> <input type="text" id="sdt" value="" readonly></td>
                            </tr>
                            <tr>
                                <td>Lớp  </td>
                                <td><input type="text" id="lop" value="" readonly> </td>	
                            </tr>
                        </table>
                      </div>
              </div>
        </div>        
    </div>
    <div class="clear"></div>
    <div class="footer">
        <p ><h4>Email: diemdanhkhuonmat@gmail.com &emsp; &emsp; &emsp; Sđt: 0384444284</h4></p>
    </div>
    <script type="module">
        // Import tde functions you need from tde SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.3/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.3/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products tdat you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyD5JNwgNouvihlohxiGa8Bpg67pkmvkFK8",
            autdDomain: "mydbpbl5.firebaseapp.com",
            databaseURL: "https://mydbpbl5-default-rtdb.firebaseio.com",
            projectId: "mydbpbl5",
            storageBucket: "mydbpbl5.appspot.com",
            messagingSenderId: "779874823764",
            appId: "1:779874823764:web:73a3033d24ed17902ac7c1",
            measurementId: "G-E7XC29K07T"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        import {getDatabase, ref, get, set, child, update, remove, onValue} 
        from "https://www.gstatic.com/firebasejs/9.8.3/firebase-database.js";

        const db = getDatabase();
        
        //--------references--------
        var idsv = document.getElementById("idsv"); 
        var ten = document.getElementById("ten"); 
        var ngaysinh = document.getElementById("ngaysinh");
        var sdt = document.getElementById("sdt");
        var mail = document.getElementById("mail");
        var lop = document.getElementById("lop");
        var image = document.getElementById("avtGiangvien");
        var avatar;

        //--------function--------
        function Selectdata() {
            const dbref = ref(db);
            get(child(dbref,"Student/"+idsvload)).then((snapshot)=>{
                if(snapshot.exists()){
                    idsv.value = snapshot.key;
                    ten.value = snapshot.val().name;
                    ngaysinh.value = snapshot.val().birthday;
                    mail.value = snapshot.val().mail;
                    sdt.value = snapshot.val().phone;
                    const dbref1 = ref(db,'ActivityClass/'+snapshot.val().idclass);
                    onValue(dbref1,(snapshot1) =>{
                        lop.value = snapshot1.val().nameclass;
                    })
                    avatar = snapshot.val().image;
                    image.innerHTML = '<img src= "../images/'+avatar+'" widtd="200px" height="200px">';
                   
                }
                else{
                    alert("No data found");
                }
            })
            .catch((error)=>{
                alert("Unsuccessful: "+error);
            });
        }

        window.onload = Selectdata;

        
        //--------events--------

        const queryString = window.location.search;
        console.log(queryString);

        const urlParams = new URLSearchParams(queryString);

        const idsvload = urlParams.get('idsv')
        console.log(idsvload);
    </script>  
</body>
</html>