<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web quản lý sinh viên</title>
    <link rel="stylesheet"  href="../css/style.css">
    <link rel="stylesheet" href="../css/fontawesome/css/all.css">
    <style>
       
    </style>
</head>
<body>
    <div class="header">
        
    </div>
    <div class="menu"> 
        <ul class="list_menu">
            <li><a href="manage.html">Trang chủ</a></li>
            <li><a href="lop.html"><i class="fas fa-users"></i>&ensp;LỚP</a></li>
            <li><a href="sinhvien.html"><i class="fas fa-graduation-cap"></i>&ensp;SINH VIÊN</a></li>
            <li><a href="diemdanh.html"><i class="fas fa-check"></i>&ensp;ĐIỂM DANH</a></li>
            <li><a href="contact.html" ><i class="fas fa-address-book"></i>&ensp;CONTACT</a></li>                
        </ul>
    </div>
    <div class="main">
        <div id="maincontain"> 
            <h2>DANH SÁCH LỚP </h2><br>
            <div id="listSV">
                <form metdod= "post" id= "f_search"> <input id = "txtSearch" type="search" name= "search" placeholder = "Nhập lớp hoặc id">
                    <input id= "btnSearch" type = "submit" name = "tim" value="" > 
                    </form>
                    <table id= "listclass" widtd = "70%">
                        <tr>
                            <th>STT</th>
                            <th width="15%">ID lớp</th> 
                            <th>ID môn</th>
                            <th>Thời khóa biểu </th>
                            <th>Tuần học </th>
                            <th>Tên lớp</th>
                            <th>Danh sách</th>
                        </tr>
                        <tbody id="tbody1" >

                        </tbody>
                    </table>
            </div>
            <form id="formChucnang">
                <a href="chucnang/themlop.html" ><input  id="btnThemSV" type="button" value="THÊM LỚP"> </a>
            </form>
      </div>
    </div>
    <div class="clear"></div>
    <div class="footer">
        <p ><h4>Email: diemdanhkhuonmat@gmail.com &emsp; &emsp; &emsp; Sđt: 0384444284</h4></p>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
        apiKey: "AIzaSyD5JNwgNouvihlohxiGa8Bpg67pkmvkFK8",
        authDomain: "mydbpbl5.firebaseapp.com",
        databaseURL: "https://mydbpbl5-default-rtdb.firebaseio.com",
        projectId: "mydbpbl5",
        storageBucket: "mydbpbl5.appspot.com",
        messagingSenderId: "779874823764",
        appId: "1:779874823764:web:73a3033d24ed17902ac7c1",
        measurementId: "G-E7XC29K07T"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        import {getDatabase, ref, get, set, child, update, remove, onValue} 
        from "https://www.gstatic.com/firebasejs/9.8.4/firebase-database.js";

        const db = getDatabase();
        
        //--------variable--------
        var stdNo = 0;
        var tbody = document.getElementById("tbody1");
        
        //--------function--------

        function Selectdata() {
            const dbref = ref(db);
            get(child(dbref,"Account/"+name.value)).then((snapshot)=>{
                if(snapshot.exists()){
                    descrip.value = snapshot.val().Descript;
                    mail.value = snapshot.val().Mail;
                    password.value = snapshot.val().PassWord;
                }
                else{
                    alert("No data found");
                }
            })
            .catch((error)=>{
                alert("Unsuccessful: "+error);
            });
        }
        function GetAllDataRealtime(){
            const dbref = ref(db,'ClassSection');
            onValue(dbref,(snapshot) =>{
               var classSection = [];

               snapshot.forEach(childSnapshot =>{
                AddItemsToTable(childSnapshot.key, childSnapshot.val().dayofweek, childSnapshot.val().idsubject, childSnapshot.val().lessonstart, childSnapshot.val().lessonend, childSnapshot.val().room,  childSnapshot.val().nameclass, childSnapshot.val().weekstart,  childSnapshot.val().weekend);
               });
            })
        }
        
        //--------Filing tde table--------
        function AddItemsToTable(idclass, day, idsubject, lessonStart, lessonEnd, room, nameclass, weekstart, weekend) {
            var trow = document.createElement("tr");
            var td1 = document.createElement("td");
            var td2 = document.createElement("td");
            var td3 = document.createElement("td");
            var td4 = document.createElement("td");
            var td5 = document.createElement("td");
            var td6 = document.createElement("td");
            var td7 = document.createElement("td");

            td1.innerHTML = ++stdNo;
            td2.innerHTML = idclass;
            td3.innerHTML = idsubject;
            td4.innerHTML = day+", "+lessonStart+"-"+lessonEnd+", "+room;
            td5.innerHTML = weekstart+"-"+weekend;
            td6.innerHTML = nameclass;
            td7.innerHTML = '<a href="dslop.html?idclass='+ idclass +'"><input type="button" value="Danh sách">';
        
            trow.appendChild(td1);
            trow.appendChild(td2);
            trow.appendChild(td3);
            trow.appendChild(td4);
            trow.appendChild(td5);
            trow.appendChild(td6);
            trow.appendChild(td7);
            tbody.appendChild(trow);
        }

        //--------events--------
        window.onload = GetAllDataRealtime;
    

    </script>
</body>
</html>